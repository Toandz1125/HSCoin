<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSCoin - H·ªó tr·ª£ h·ªçc sinh, sinh vi√™n</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <a href="#" class="logo">
            <!-- Using a placeholder image since the provided URL returns a 404 error -->
            <img src="https://res.cloudinary.com/dslsdpxaf/image/upload/v1742269378/p4m25lkmwqquqwrxg2i0.png" alt="HSCoin Logo">
            HSCoin
        </a>
        <nav>
            <ul>
                <li><a href="#info-section">Gi·ªõi thi·ªáu</a></li>
                <li><a href="#">T√†i nguy√™n</a></li>
                <li><a href="#">S·ª± ƒë·ªïi m·ªõi</a></li>
                <li><a href="#">Tham gia</a></li>
                <li><a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
            </ul>
        </nav>
        <div class="right-nav">
            <a href="#">Ti·∫øng vi·ªát ‚ñº</a>
            <a href="auth/register.html">üë§</a>
        </div>
    </header>
    <main>
        <!-- Hero Section -->
        <section class="hero-main">
            <a class="logo-center">
                <h1>HSCoin</h1>
            </a>
            <p>Th·∫ø h·ªá ti·ªÅn k·ªπ thu·∫≠t s·ªë ti·∫øp theo. An to√†n, nhanh ch√≥ng v√† mang t√≠nh c√°ch m·∫°ng.</p>
            <div class="cta-buttons">
                <a href="auth/register.html" class="cta-button primary-button">B·∫Øt ƒë·∫ßu</a>
                <a href="#info-section" class="cta-button secondary-button">T√¨m hi·ªÉu th√™m</a>
            </div>
        </section>

        <!-- Info Section -->
        <section id = "info-section" class="info-section">
            <h2>HSCoin l√† m·ªôt m·∫°ng l∆∞·ªõi thanh to√°n s√°ng t·∫°o v√† l√† m·ªôt lo·∫°i ti·ªÅn m·ªõi.</h2>
            <p>ƒê∆∞·ª£c x√¢y d·ª±ng tr√™n c√¥ng ngh·ªá blockchain ti√™n ti·∫øn, HSCoin cung c·∫•p kh·∫£ nƒÉng b·∫£o m·∫≠t ch∆∞a t·ª´ng c√≥, giao d·ªãch nhanh nh∆∞ ch·ªõp v√† h·ªá sinh th√°i t√†i ch√≠nh th·ª±c s·ª± phi t·∫≠p trung, gi√∫p b·∫°n n·∫Øm l·∫°i quy·ªÅn ki·ªÉm so√°t.</p>
            
            <div class="action-buttons">
                <a href="auth/register.html" class="action-button orange-button">B·∫Øt ƒë·∫ßu v·ªõi HSCoin</a>
                <a href="#" class="action-button outline-button">Ch·ªçn v√≠ c·ªßa b·∫°n</a>
                <a href="auth/login.html" class="action-button outline-button">Mua HSCoin</a>
            </div>
            
            <div class="video-section">
                <a href="#" class="video-button">
                    <div class="play-icon">‚ñ∂</div>
                    <div class="video-text">HSCoin?</div>
                </a>
            </div>
        </section>

        <!-- Network Graphic -->
         <h2> C√¥ng ngh·ªá blockchain v√† m√£ h√≥a </h2>
        <div class="network-graphic"></div>

        <section id="about" class="about-section">
            <br>
            <br>
            <h2>Nhi·ªám v·ª• c·ªßa ch√∫ng t√¥i</h2>
            <p>Ch√∫ng t√¥i k·∫øt n·ªëi c√°c sinh vi√™n c√°c tr∆∞·ªùng ƒë·∫°i h·ªçc v·ªõi c√°c m·ª•c ƒë√≠ch c√≥ √Ω nghƒ©a, t·∫°o m√¥i tr∆∞·ªùng kinh doanh bu√¥n b√°n cho sinh vi√™n, h·ªó tr·ª£ qu·∫£n l√Ω sinh vi√™n, ƒë·∫£m b·∫£o t√≠nh minh b·∫°ch v√† t√°c ƒë·ªông trong m·ªçi giao d·ªãch.</p>
            <div class="stats">
                <div class="stat-item">
                    <h3>1000+</h3>
                    <p>Th√†nh vi√™n</p>
                </div>
                <div class="stat-item">
                    <h3>50+</h3>
                    <p>Ch·ª©c nƒÉng</p>
                </div>
                <div class="stat-item">
                    <h3>HSC500K+</h3>
                    <p>ƒê∆∞·ª£c ƒë∆∞a ra</p>
                </div>
            </div>
            <br>
        </section>

        <section id="causes" class="causes-section">
            <br>
            <br>
            <h2>C√°c ch·ª©c nƒÉng hi·ªán t·∫°i</h2>
            <div class="causes-grid" id="causes-container">
                <!-- Causes will be loaded dynamically -->
            </div>
            <div id="grand-total"></div>
            <br>
            <br>
            <br>
        </section>
        
        <section id="causes" class="causes-section">
            <h2>Danh s√°ch giao d·ªãch</h2>
                <div id="filter-buttons">
                    <button id="all-donations" class="filter-btn">T·∫•t c·∫£</button>
                    <button id="books" class="filter-btn">S√°ch</button>
                    <button id="trees" class="filter-btn">C√¢y</button>
                    <button id="event tickets" class="filter-btn">V√© s·ª± ki·ªán</button>
                    <button id="lab entrance ticket" class="filter-btn">V√© v√†o ph√≤ng nghi√™n c·ª©u</button>
                    <button id="Buy HSC" class="filter-btn">Mua Coin</button>
                    <button id="Sell HSC" class="filter-btn">B√°n Coin</button>
                    <button id="Payment Tuition" class="filter-btn">ƒê√≥ng h·ªçc ph√≠</button>
                </div>
        </section>
        <div id="table-container">
            <table id="donation-table">
                <thead>
                    <tr>
                        <th>Th·ªùi gian</th>
                        <th>S·ªë l∆∞·ª£ng (HSC)</th>
                        <th>Nguy√™n nh√¢n</th>
                        <th>T√™n ng∆∞·ªùi d√πng</th>
                        <th>Email ng∆∞·ªùi d√πng</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Donation history will be populated here -->
                </tbody>
            </table>
        </div>
    </main>
    <br>
    <br>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>HSCoin</h3>
                <p>M·ªôt m√¥i tr∆∞·ªùng m·ªõi, m·ªôt ƒë·ªìng ti·ªÅn cho sinh vi√™n.</p>
            </div>
            <div class="footer-section">
                <h3>Li√™n l·∫°c</h3>
                <p>Email: naithetoan2005@gmail.com</p>
                <p>S·ªë ƒëi·ªán tho·∫°i: (+84) 869 744 213</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 HSCoin. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const causeTotalsDiv = document.getElementById('causes-container');
            const grandTotalDiv = document.getElementById('grand-total');
        
            try {
                const response = await fetch('/auth/api/donation_stats');
                const data = await response.json();
        
                if (data.success) {
                    const stats = data.stats;
                    let totalsHtml = '<div class="stats-grid">';
                    let grandTotal = 0;
        
                    for (const cause in stats) {
                        const amount = stats[cause];
                        grandTotal += amount;
                        totalsHtml += `
                            <div class="stat-card">
                                <h3>${cause.charAt(0).toUpperCase() + cause.slice(1)}</h3>
                                <p class="amount">$${amount.toFixed(2)}</p>
                            </div>
                        `;
                    }
                    totalsHtml += '</div>';
                    causeTotalsDiv.innerHTML = totalsHtml;
                    
                    // Display grand total
                    grandTotalDiv.innerHTML = `
                        <div class="grand-total">
                            <h3>Total Transaction</h3>
                            <p class="amount">$${grandTotal.toFixed(2)}</p>
                        </div>
                    `;
                } else {
                    causeTotalsDiv.innerHTML = '<p class="error">Failed to load donation statistics.</p>';
                }
            } catch (error) {
                causeTotalsDiv.innerHTML = '<p class="error">Error loading donation statistics. Please try again later.</p>';
                console.error('Error:', error);
            }
        });

        document.addEventListener('DOMContentLoaded', async () => {
            const donationTableBody = document.getElementById('donation-table').querySelector('tbody');
            const filterButtons = document.querySelectorAll('.filter-btn');

            async function fetchDonations(cause = '') {
                try {
                    const response = await fetch(`/auth/api/all_donations`);
                    const data = await response.json();

                    if (data.success) {
                        const donations = data.donations;

                        // S·∫Øp x·∫øp donations theo th·ªùi gian t·ª´ m·ªõi nh·∫•t ƒë·∫øn c≈© nh·∫•t
                        donations.sort((a, b) => new Date(b.date) - new Date(a.date));

                        // L·ªçc donations theo cause n·∫øu c√≥
                        const filteredDonations = cause ? donations.filter(donation => donation.cause === cause) : donations;

                        // Hi·ªÉn th·ªã donations
                        displayDonations(filteredDonations);
                    } else {
                        donationTableBody.innerHTML = '<tr><td colspan="5" class="error">Kh√¥ng th·ªÉ t·∫£i donations.</td></tr>';
                    }
                } catch (error) {
                    donationTableBody.innerHTML = '<tr><td colspan="5" class="error">L·ªói khi t·∫£i donations. Vui l√≤ng th·ª≠ l·∫°i sau.</td></tr>';
                    console.error('Error:', error);
                }
            }

            function displayDonations(donations) {
                donationTableBody.innerHTML = ''; // X√≥a n·ªôi dung c≈©
                donations.forEach(donation => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${new Date(donation.date).toLocaleString()}</td>
                        <td>${donation.amount.toFixed(2)}</td>
                        <td>${donation.cause}</td>
                        <td>${donation.user_name}</td>
                        <td>${donation.user_email}</td>
                    `;
                    donationTableBody.appendChild(row);
                });
            }

            // L·∫•y t·∫•t c·∫£ donations khi t·∫£i trang
            fetchDonations();

            // Th√™m s·ª± ki·ªán cho c√°c n√∫t l·ªçc
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const cause = button.id === 'all-donations' ? '' : button.id;
                    fetchDonations(cause);
                });
            });
        });
    </script>
</body>
</html>
